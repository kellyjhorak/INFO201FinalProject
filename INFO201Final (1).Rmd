---
title: "info201Final"
output: html_document
date: "2023-12-01"
---

# START OF INFO 201 PROJECT 
## Downloading Data
```{r}
library(tidyverse)

gdp <- read.csv("gdp.csv")
global_education <- read.csv("global_education.csv")
```

## Merging Data
```{r}
gdp_global_education <- left_join(gdp, global_education, by = c("Country.Territory" = "Countries.and.areas"))
```

## Load Merged Data
```{r}
ls(gdp_global_education)
```

## Find the completion rate in males and females
```{r}
completionRate <- subset(gdp_global_education, select =c("Country.Territory", "Completion_Rate_Primary_Male", "Completion_Rate_Primary_Female"))

completionRate <- na.omit(completionRate)
```


## Find the youth 15-24 literacy rate in males and females 
```{r}
youthLiteracyRate <- subset(gdp_global_education, select =c("Country.Territory", "Youth_15_24_Literacy_Rate_Female", "Youth_15_24_Literacy_Rate_Male"))

youthLiteracyRate <- na.omit(completionRate)
```


## Find gross primary enrollment in education 
```{r}
grossPrimaryEnrollment <- subset(gdp_global_education, select =c("Country.Territory", "Gross_Primary_Education_Enrollment"))

grossPrimaryEnrollment <- na.omit(grossPrimaryEnrollment)
```

## Find unemployment rates
```{r}
unemploymentRates <- subset(gdp_global_education, select =c("Country.Territory", "Unemployment_Rate"))

unemploymentRates <- na.omit(unemploymentRates)
```

## MERGED DATASET WITH ALL VARIABLES WE NEED
```{r}
FINALgdp_global_education <- subset(gdp_global_education, select =c("Country.Territory", "IMF", "Completion_Rate_Primary_Male", "Completion_Rate_Primary_Female", "Youth_15_24_Literacy_Rate_Female", "Youth_15_24_Literacy_Rate_Male", "Gross_Primary_Education_Enrollment", "Unemployment_Rate"  ))

## gets rid of na values
FINALgdp_global_education <- na.omit(FINALgdp_global_education)

## gets rid of all 0 values in gdp (IMF)
FINALgdp_global_education <- FINALgdp_global_education[FINALgdp_global_education$IMF != 0, ]
```

##changing IMF to be numerical, not character
### IMF = GDP per capita estimated by the International Monetary Fund
```{r}
FINALgdp_global_education$IMF <- as.numeric(FINALgdp_global_education$IMF)

min_value <- min(FINALgdp_global_education$IMF)
max_value <- max(FINALgdp_global_education$IMF)

print(paste("Minimum value:", min_value))
print(paste("Maximum value:", max_value))
```

## Adding a categorical variable to the dataset: make different income classes, and sort each country into its own bin.

```{r}
FINALgdp_global_education <- mutate(FINALgdp_global_education,
                       Rank_of_GDP_per_Capita = case_when(
                           IMF >= 0 & IMF <= 1000 ~ "Very Low",
                           IMF >= 1000 & IMF <= 5000 ~ "Low",
                           IMF >= 5001 & IMF <= 25000 ~ "Mid",
                           IMF >= 25001 ~ "High",
                           TRUE ~ NA_character_  # Catch-all for other cases
                       ))

rank_counts <- FINALgdp_global_education %>%
  count(Rank_of_GDP_per_Capita)

# Display the counts
print(rank_counts)

```

## Adding a numerical variable: This calculates an education index by taking the average of completion rates for both male and female, the average of literacy rates for both genders, and adds the gross primary education enrollment. Finally, it normalizes the index between 0 and 1 to make it more interpretable and comparable across different scales.

```{r}
# Assuming your dataset is named 'education_data'
FINALgdp_global_education$Education_Index <- (
    (FINALgdp_global_education$Completion_Rate_Primary_Male + FINALgdp_global_education$Completion_Rate_Primary_Female) / 2 +
    (FINALgdp_global_education$Youth_15_24_Literacy_Rate_Female + FINALgdp_global_education$Youth_15_24_Literacy_Rate_Male) / 2 +
    FINALgdp_global_education$Gross_Primary_Education_Enrollment
) / 3

# Normalize the index between 0 and 1
FINALgdp_global_education$Education_Index <- (FINALgdp_global_education$Education_Index - min(FINALgdp_global_education$Education_Index)) /
                                  (max(FINALgdp_global_education$Education_Index) - min(FINALgdp_global_education$Education_Index))
```

### FINAL DATASET
```{r}
FINALgdp_global_education
```

## EDIT LATER Make scatterplot of education index in correlation to GDP (gdp on x axis up to 130k, education index on y axis 0-1)


## plot each gdp bin with its corresponding completion rate for primaryrate(female)
```{r}
# Load necessary libraries
# Load necessary libraries
library(ggplot2)

# Assuming FINALgdp_global_education is your dataset
# Replace 'Completion_Rate_Primary_Female' and 'Rank_of_GDP_per_Capita' with your actual column names

# Filter out rows where Completion_Rate_Primary_Female is not equal to 0
filtered_data <- FINALgdp_global_education %>%
  filter(Completion_Rate_Primary_Female != 0)

# Create a boxplot with adjustments using the filtered data
ggplot(filtered_data, aes(x = Rank_of_GDP_per_Capita, y = Completion_Rate_Primary_Female)) +
  geom_boxplot(fill = "skyblue", color = "blue", alpha = 0.7, width = 0.5) +
  labs(title = "Completion Rate for Primary Education (Female) vs. GDP per Capita Rank",
       x = "Rank of GDP per Capita",
       y = "Completion Rate for Primary Education (Female)") +
  theme_minimal() +
  scale_x_discrete(labels = c("Low" = "Low GDP", "Mid" = "Mid GDP", "High" = "High GDP")) +
  coord_cartesian(ylim = c(min(filtered_data$Completion_Rate_Primary_Female), max(filtered_data$Completion_Rate_Primary_Female)))
```


## plot each gdp bin with its corresponding completion rate for primaryrate(male) 
```{r}
# Load necessary libraries
library(ggplot2)

# Assuming FINALgdp_global_education is your dataset
# Replace 'Completion_Rate_Primary_Male' and 'Rank_of_GDP_per_Capita' with your actual column names

# Create a boxplot for Completion_Rate_Primary_Male
ggplot(FINALgdp_global_education, aes(x = Rank_of_GDP_per_Capita, y = Completion_Rate_Primary_Male)) +
  geom_boxplot(fill = "skyblue", color = "blue", alpha = 0.7) +
  labs(title = "Completion Rate for Primary Education (Male) vs. GDP per Capita Rank",
       x = "Rank of GDP per Capita",
       y = "Completion Rate for Primary Education (Male)") +
  theme_minimal() +
  scale_x_discrete(labels = c("Low" = "Low GDP", "Mid" = "Mid GDP", "High" = "High GDP"))
```

## plot GDP and Unemployment rate 
```{r}
# Assuming FINALgdp_global_education is your dataset
# Replace 'IMF' and 'Unemployment_Rate' with your actual column names

# Create a bar plot for Unemployment_Rate vs. IMF
ggplot(FINALgdp_global_education, aes(x = IMF, y = Unemployment_Rate)) +
  geom_point(stat = "identity", fill = "skyblue", color = "blue", alpha = 0.7) +
  labs(title = "Unemployment Rate vs. IMF",
       x = "IMF",
       y = "Unemployment Rate") +
  theme_minimal()

```
